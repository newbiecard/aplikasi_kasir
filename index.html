<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçÉ Nasi Daun Jeruk POS | Sistem Kasir Modern</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üçÉ</text></svg>">
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-content">
            <div class="loading-logo">üçÉ</div>
            <div class="loading-text">Memuat Sistem Kasir...</div>
            <div class="loading-dots">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container" id="mainContainer">
        <!-- Header -->
        <header class="main-header">
            <div class="header-left">
                <div class="logo">
                    <span class="logo-icon">üçÉ</span>
                    <div class="logo-text">
                        <h1>Nasi Daun Jeruk</h1>
                        <p class="tagline">Point of Sale System</p>
                    </div>
                </div>
                <div class="connection-status" id="connectionStatus">
                    <div class="status-indicator offline"></div>
                    <span>Menyambung...</span>
                </div>
            </div>
            <div class="header-right">
                <div class="header-info">
                    <div class="info-item">
                        <i class="fas fa-clock"></i>
                        <span id="currentTime">--:--:--</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-calendar"></i>
                        <span id="currentDate">--/--/----</span>
                    </div>
                </div>
                <button class="btn-header" id="btnDashboard">
                    <i class="fas fa-chart-line"></i> Dashboard
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Left Panel: Menu Selection -->
            <section class="panel menu-panel">
                <div class="panel-header">
                    <h2><i class="fas fa-utensils"></i> Menu & Harga</h2>
                    <div class="panel-badge" id="orderCount">0 Item</div>
                </div>
                
                <!-- Nasi Daun Jeruk Section -->
                <div class="menu-section">
                    <h3 class="section-title">
                        <i class="fas fa-leaf"></i> Nasi Daun Jeruk
                        <span class="section-subtitle">Aroma wangi, rasa istimewa</span>
                    </h3>
                    
                    <div class="menu-grid">
                        <!-- Paket Dasar -->
                        <div class="menu-card" data-id="nasi-dasar" data-price="10000">
                            <div class="menu-card-header">
                                <div class="menu-icon">üçö</div>
                                <div class="menu-tags">
                                    <span class="tag bestseller">Terlaris</span>
                                </div>
                            </div>
                            <div class="menu-card-body">
                                <h4>Nasi Daun Jeruk</h4>
                                <p class="menu-description">Paket dasar dengan nasi wangi daun jeruk</p>
                                <div class="menu-price">
                                    <span class="price">Rp 10.000</span>
                                    <span class="price-note">per porsi</span>
                                </div>
                            </div>
                            <div class="menu-card-footer">
                                <button class="btn-menu-add" data-id="nasi-dasar">
                                    <i class="fas fa-plus-circle"></i> Tambah
                                </button>
                            </div>
                        </div>

                        <!-- Paket Lengkap -->
                        <div class="menu-card highlight" data-id="paket-lengkap" data-price="12000">
                            <div class="menu-card-header">
                                <div class="menu-icon">üëë</div>
                                <div class="menu-tags">
                                    <span class="tag recommended">Rekomendasi</span>
                                    <span class="tag value">Hemat</span>
                                </div>
                            </div>
                            <div class="menu-card-body">
                                <h4>Paket Lengkap</h4>
                                <p class="menu-description">Nasi + Ayam Suwir + Kulit Krispi</p>
                                <div class="menu-price">
                                    <span class="price">Rp 12.000</span>
                                    <span class="price-note">hemat Rp 3.000</span>
                                </div>
                                <div class="menu-savings">
                                    <i class="fas fa-badge-percent"></i> Lebih hemat 20%
                                </div>
                            </div>
                            <div class="menu-card-footer">
                                <button class="btn-menu-add highlight" data-id="paket-lengkap">
                                    <i class="fas fa-crown"></i> Pilih Paket
                                </button>
                            </div>
                        </div>

                        <!-- Topping Section -->
                        <div class="menu-card topping-card" data-id="ayam-suwir" data-price="0">
                            <div class="menu-card-header">
                                <div class="menu-icon">üçó</div>
                            </div>
                            <div class="menu-card-body">
                                <h4>Ayam Suwir</h4>
                                <p class="menu-description">Topping ayam suwir spesial</p>
                                <div class="menu-price">
                                    <span class="price">+ Gratis</span>
                                    <span class="price-note">dengan paket</span>
                                </div>
                            </div>
                            <div class="menu-card-footer">
                                <button class="btn-menu-add" data-id="ayam-suwir">
                                    <i class="fas fa-plus"></i> Topping
                                </button>
                            </div>
                        </div>

                        <div class="menu-card topping-card" data-id="kulit-krispi" data-price="0">
                            <div class="menu-card-header">
                                <div class="menu-icon">ü•ì</div>
                            </div>
                            <div class="menu-card-body">
                                <h4>Kulit Ayam Krispi</h4>
                                <p class="menu-description">Kulit ayam krispi renyah</p>
                                <div class="menu-price">
                                    <span class="price">+ Gratis</span>
                                    <span class="price-note">dengan paket</span>
                                </div>
                            </div>
                            <div class="menu-card-footer">
                                <button class="btn-menu-add" data-id="kulit-krispi">
                                    <i class="fas fa-plus"></i> Topping
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Minuman Section -->
                <div class="menu-section">
                    <h3 class="section-title">
                        <i class="fas fa-glass-whiskey"></i> Minuman
                        <span class="section-subtitle">Segarkan hari Anda</span>
                    </h3>
                    
                    <div class="menu-grid">
                        <div class="menu-card" data-id="es-jeruk" data-price="5000">
                            <div class="menu-card-header">
                                <div class="menu-icon">üßÉ</div>
                                <div class="menu-tags">
                                    <span class="tag fresh">Fresh</span>
                                </div>
                            </div>
                            <div class="menu-card-body">
                                <h4>Es Jeruk Peras</h4>
                                <p class="menu-description">Jeruk peras asli dengan es batu</p>
                                <div class="menu-price">
                                    <span class="price">Rp 5.000</span>
                                    <span class="price-note">per gelas</span>
                                </div>
                            </div>
                            <div class="menu-card-footer">
                                <button class="btn-menu-add" data-id="es-jeruk">
                                    <i class="fas fa-plus-circle"></i> Tambah
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Right Panel: Order & Payment -->
            <section class="panel order-panel">
                <div class="panel-header">
                    <h2><i class="fas fa-receipt"></i> Pesanan Aktif</h2>
                    <button class="btn-clear" id="btnClearOrder">
                        <i class="fas fa-trash-alt"></i> Kosongkan
                    </button>
                </div>

                <!-- Order List -->
                <div class="order-list-container">
                    <div class="order-list" id="orderList">
                        <div class="empty-order">
                            <div class="empty-icon">
                                <i class="fas fa-shopping-basket"></i>
                            </div>
                            <h3>Belum ada pesanan</h3>
                            <p>Pilih menu dari panel kiri untuk memulai</p>
                        </div>
                    </div>
                </div>

                <!-- Order Summary -->
                <div class="order-summary">
                    <div class="summary-row">
                        <span>Subtotal</span>
                        <span id="subtotal">Rp 0</span>
                    </div>
                    <div class="summary-row">
                        <span>Jumlah Item</span>
                        <span id="itemCount">0</span>
                    </div>
                    <div class="summary-row total">
                        <span>Total Pembayaran</span>
                        <span id="totalAmount">Rp 0</span>
                    </div>
                </div>

                <!-- Quantity Control -->
                <div class="quantity-control">
                    <h3><i class="fas fa-sliders-h"></i> Atur Jumlah</h3>
                    <div class="qty-input-group">
                        <button class="qty-btn" id="qtyDecrease">
                            <i class="fas fa-minus"></i>
                        </button>
                        <input type="number" id="qtyInput" value="1" min="1" max="99">
                        <button class="qty-btn" id="qtyIncrease">
                            <i class="fas fa-plus"></i>
                        </button>
                        <button class="btn-update" id="btnUpdateQty">
                            <i class="fas fa-sync-alt"></i> Update
                        </button>
                    </div>
                    <p class="qty-hint">Pilih item di daftar pesanan, lalu atur jumlah</p>
                </div>

                <!-- Payment Section -->
                <div class="payment-section">
                    <h3><i class="fas fa-cash-register"></i> Pembayaran</h3>
                    
                    <div class="payment-input-group">
                        <label for="cashAmount">
                            <i class="fas fa-money-bill-wave"></i> Uang Diterima
                        </label>
                        <div class="input-with-prefix">
                            <span class="input-prefix">Rp</span>
                            <input type="number" id="cashAmount" placeholder="0" min="0">
                        </div>
                    </div>

                    <div class="payment-calculator">
                        <div class="calc-row">
                            <span>Kembalian</span>
                            <span id="changeAmount">Rp 0</span>
                        </div>
                        <div class="calc-status" id="paymentStatus">
                            <i class="fas fa-info-circle"></i>
                            <span>Masukkan jumlah uang</span>
                        </div>
                    </div>

                    <div class="payment-actions">
                        <button class="btn-calculate" id="btnCalculate">
                            <i class="fas fa-calculator"></i> Hitung Kembalian
                        </button>
                        <button class="btn-process" id="btnProcess" disabled>
                            <i class="fas fa-paper-plane"></i> Proses Transaksi
                        </button>
                    </div>
                </div>

                <!-- Transaction Log -->
                <div class="transaction-log">
                    <h3><i class="fas fa-history"></i> Aktivitas Terakhir</h3>
                    <div class="log-list" id="activityLog">
                        <div class="log-item">
                            <span class="log-time">12:00:00</span>
                            <span class="log-message">Sistem siap digunakan</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="main-footer">
            <div class="footer-left">
                <div class="sync-status">
                    <i class="fas fa-sync-alt"></i>
                    <span id="syncStatus">Sinkronisasi: Offline</span>
                    <span class="last-sync" id="lastSync">-</span>
                </div>
                <div class="transaction-counter">
                    <i class="fas fa-database"></i>
                    <span>Transaksi: <span id="transactionCount">0</span></span>
                </div>
            </div>
            <div class="footer-right">
                <button class="btn-footer" id="btnSettings">
                    <i class="fas fa-cog"></i> Pengaturan
                </button>
                <button class="btn-footer" id="btnHelp">
                    <i class="fas fa-question-circle"></i> Bantuan
                </button>
                <button class="btn-footer primary" id="btnQuickSale">
                    <i class="fas fa-bolt"></i> Cepat (F2)
                </button>
            </div>
        </footer>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-cog"></i> Pengaturan Sistem</h2>
                <button class="modal-close" id="closeSettings">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-tabs">
                    <button class="tab-btn active" data-tab="google">Google Sheets</button>
                    <button class="tab-btn" data-tab="printer">Printer</button>
                    <button class="tab-btn" data-tab="backup">Backup</button>
                </div>
                
                <div class="tab-content active" id="tabGoogle">
                    <div class="form-group">
                        <label for="scriptUrl">
                            <i class="fas fa-link"></i> URL Google Apps Script
                        </label>
                        <input type="text" id="scriptUrl" 
                               placeholder="https://script.google.com/macros/s/.../exec">
                        <small class="form-help">
                            Dapatkan dari: Deploy ‚Üí Manage deployments ‚Üí Copy URL
                        </small>
                    </div>
                    
                    <div class="form-group">
                        <label for="spreadsheetId">
                            <i class="fas fa-table"></i> ID Spreadsheet
                        </label>
                        <input type="text" id="spreadsheetId" 
                               placeholder="1xYzAbCdEfGhIjKlMnOpQrStUvWxYz123456789">
                        <small class="form-help">
                            Dari URL spreadsheet: /d/[ID_INI]/edit
                        </small>
                    </div>
                    
                    <div class="test-connection">
                        <button class="btn-test" id="btnTestConnection">
                            <i class="fas fa-vial"></i> Test Koneksi
                        </button>
                        <div class="test-result" id="testResult"></div>
                    </div>
                    
                    <div class="form-actions">
                        <button class="btn-cancel" id="cancelSettings">Batal</button>
                        <button class="btn-save" id="saveSettings">
                            <i class="fas fa-save"></i> Simpan Pengaturan
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal success" id="successModal">
        <div class="modal-content">
            <div class="modal-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h2>Transaksi Berhasil!</h2>
            <div class="modal-body">
                <div class="transaction-details">
                    <div class="detail-row">
                        <span>Total</span>
                        <span id="successTotal">Rp 0</span>
                    </div>
                    <div class="detail-row">
                        <span>Uang Diterima</span>
                        <span id="successCash">Rp 0</span>
                    </div>
                    <div class="detail-row highlight">
                        <span>Kembalian</span>
                        <span id="successChange">Rp 0</span>
                    </div>
                    <div class="detail-row">
                        <span>ID Transaksi</span>
                        <span id="successId" class="transaction-id">T-0000</span>
                    </div>
                </div>
                <p class="success-message">
                    Data telah disimpan ke Google Sheets dan sistem.
                </p>
            </div>
            <div class="modal-footer">
                <button class="btn-print" id="btnPrint">
                    <i class="fas fa-print"></i> Cetak Struk
                </button>
                <button class="btn-close-modal" id="closeSuccess">
                    <i class="fas fa-times"></i> Tutup (ESC)
                </button>
            </div>
        </div>
    </div>

    <!-- Notifications -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- Scripts -->
    <script src="config.js"></script>
    <script src="script.js"></script>
    <script src="sync.js"></script>
</body>
</html>